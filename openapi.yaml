openapi: 3.0.3
info:
  title: Eficience Shadow
  version: 1.0.0
  description: |
    API para gerenciamento de usuários: cadastro, login e login via Google OAuth.
    - Autenticação via JWT (Bearer)
    - Arquitetura vertical slice
  contact:
    name: Werner
  termsOfService: https://example.com/terms
servers:
  - url: /
    description: Same origin
tags:
  - name: users
    description: Operações relacionadas a usuários
  - name: Work Items
    description: Operações relacionadas a work items
  - name: Metrics
    description: Métricas de fluxo, eficiência e capacidade baseadas em dados de work items
  - name: People
    description: Operações relacionadas a pessoas
  - name: Work Item Types
    description: Operações relacionadas a tipos de work items
paths:
  /users/register:
    post:
      tags: [users]
      summary: Registrar novo usuário
      description: Cria um usuário com email e senha. Retorna um JWT.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '201':
          description: Registrado com sucesso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          description: Dados inválidos
        '409':
          description: Email já cadastrado
      security: []

  /users/login:
    post:
      tags: [users]
      summary: Login com email e senha
      description: Autentica o usuário e retorna um JWT.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Autenticado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          description: Dados inválidos
        '401':
          description: Credenciais inválidas
      security: []

  /users/google:
    get:
      tags: [users]
      summary: Login social via Google OAuth
      description: |
        Inicia o fluxo OAuth (sem `code`) redirecionando para o Google.
        Quando chamado pelo Google com `code`, troca pelo token e retorna JWT.
      parameters:
        - in: query
          name: code
          required: false
          schema:
            type: string
          description: Código de autorização retornado pelo Google
        - in: query
          name: state
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Autenticado com sucesso (quando há `code`)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '302':
          description: Redireciona para o Google (quando não há `code`)
          headers:
            Location:
              schema:
                type: string
              description: URL de autorização do Google
        '400':
          description: Erro no fluxo OAuth
      security: []

  /work-items:
    get:
      summary: Lista work items com filtros, paginação e tempos de desenvolvimento
      description: |
        Retorna work items com cálculo de dias úteis de desenvolvimento (seg-sex, excluindo feriados do Brasil). 
        Início: `activatedDate` (se existir) ou `createdDate`. Fim: `closedDate`.
      parameters:
        - in: query
          name: limit
          schema: { type: integer, minimum: 1, maximum: 200, default: 50 }
          description: Quantidade de itens por página
        - in: query
          name: offset
          schema: { type: integer, minimum: 0, default: 0 }
          description: Deslocamento/página
        - in: query
          name: sortBy
          schema: { type: string, enum: [id], default: id }
        - in: query
          name: sortDir
          schema: { type: string, enum: [asc, desc], default: asc }
        - in: query
          name: id
          schema: { type: integer }
        - in: query
          name: parentId
          schema: { type: integer }
        - in: query
          name: workItemTypeId
          schema: { type: string, format: uuid }
        - in: query
          name: state
          schema: { type: string }
        - in: query
          name: assignedToId
          schema: { type: string, format: uuid }
        - in: query
          name: titleContains
          schema: { type: string }
          description: Filtro por título contendo substring (case-insensitive)
        - in: query
          name: createdFrom
          schema: { type: string, format: date-time }
        - in: query
          name: createdTo
          schema: { type: string, format: date-time }
        - in: query
          name: activatedFrom
          schema: { type: string, format: date-time }
        - in: query
          name: activatedTo
          schema: { type: string, format: date-time }
        - in: query
          name: closedFrom
          schema: { type: string, format: date-time }
        - in: query
          name: closedTo
          schema: { type: string, format: date-time }
        - in: query
          name: isClosed
          schema: { type: boolean }
          description: true = somente fechados; false = somente não fechados
        - in: query
          name: hasParent
          schema: { type: boolean }
          description: true = somente com pai; false = somente sem pai
      tags: [Work Items]
      responses:
        '200':
          description: Lista de work items com tempos de desenvolvimento, total e resumo (sem paginação)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkItemsListResponse'
        '401':
          description: Não autenticado
        '500':
          description: Erro interno do servidor

  /work-items/import:
    post:
      summary: Importa ou atualiza work items via JSON (bulk upsert)
      description: Recebe um array de work items para criar ou atualizar no banco. `work item type` é aceito como string e normalizado para tabela `work_item_types`. `parent_id` é resolvido pelo title no payload.
      tags: [Work Items]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                type: object
                required: [id, work item type, state, created date, activated date, title]
                properties:
                  id:
                    type: string
                    example: "101"
                  work item type:
                    type: string
                    example: "User Story"
                  assigned to:
                    type: string
                    nullable: true
                    example: "maria@empresa.com"
                  state:
                    type: string
                    example: "Active"
                  created date:
                    type: string
                    description: Formato DD-MM-YYYY HH:mm (UTC)
                    example: "02-11-2025 09:15"
                  activated date:
                    type: string
                    description: Formato DD-MM-YYYY HH:mm (UTC)
                    example: "02-11-2025 10:00"
                  closed date:
                    type: string
                    nullable: true
                    description: Formato DD-MM-YYYY HH:mm (UTC). Pode ser nulo/ausente.
                    example: ""
                  description:
                    type: string
                    nullable: true
                    example: "Detalhes do item de trabalho"
                  title:
                    type: string
                    example: "Implementar login"
                  parent:
                    type: string
                    nullable: true
                    description: Título do pai; usado para resolver parent_id pelo payload.
                    example: "[EPIC] Autenticação"
      responses:
        '200':
          description: Work items importados/atualizados com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  inserted:
                    type: integer
                  updated:
                    type: integer
                  ignored:
                    type: integer

  /metrics/throughput:
    get:
      tags: [Metrics]
      summary: Throughput por período (itens fechados)
      description: |
        Retorna quantidade de itens fechados agrupados por período (dia/semana/mês/trimestre).
        Agrupa por tipo de work item quando disponível.
      parameters:
        - in: query
          name: from
          schema:
            type: string
            format: date-time
          description: Data inicial (ISO 8601). Padrao 90 dias atras
        - in: query
          name: to
          schema:
            type: string
            format: date-time
          description: Data final (ISO 8601). Padrao agora
        - in: query
          name: groupBy
          schema:
            type: string
            enum:
              - day
              - week
              - month
              - quarter
            default: week
          description: Unidade de agrupamento temporal
        - in: query
          name: workItemTypeId
          schema:
            type: string
            format: uuid
          description: Filtrar por tipo de work item (opcional). Quando fornecido, retorna apenas resultados deste tipo.
      responses:
        '200':
          description: Lista de throughput por período
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ThroughputPeriod'
        '400':
          description: Parâmetros inválidos
        '401':
          description: Não autenticado

  /metrics/arrival:
    get:
      tags: [Metrics]
      summary: Taxa de chegada vs throughput
      description: |
        Compara itens criados (chegada) vs itens fechados (throughput) por período.
        Retorna delta (acumulação/queima de backlog).
      parameters:
        - in: query
          name: from
          schema:
            type: string
            format: date-time
          description: Data inicial (ISO 8601). Padrao 90 dias atras
        - in: query
          name: to
          schema:
            type: string
            format: date-time
          description: Data final (ISO 8601). Padrao agora
        - in: query
          name: groupBy
          schema:
            type: string
            enum:
              - day
              - week
              - month
              - quarter
            default: week
          description: Unidade de agrupamento temporal
      responses:
        '200':
          description: Séries temporais de chegada e throughput
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ArrivalThroughputPeriod'
        '400':
          description: Parâmetros inválidos
        '401':
          description: Não autenticado

  /metrics/wip:
    get:
      tags: [Metrics]
      summary: WIP atual (Work In Progress)
      description: |
        Retorna snapshot atual de itens em progresso (closed_date IS NULL).
        Inclui aging médio e percentis (p50/p75/p85/p90/p95) por dimensão:
        total, por tipo e por pessoa.
      responses:
        '200':
          description: WIP atual com aging e percentis
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WipSnapshot'
        '401':
          description: Não autenticado

  /metrics/lead-time:
    get:
      tags: [Metrics]
      summary: Lead time (created_date → closed_date)
      description: |
        Tempo desde criação até fechamento. Retorna percentis (p50/p75/p85/p90/p95),
        média e desvio padrão por período, tipo e pessoa.
      parameters:
        - in: query
          name: from
          schema:
            type: string
            format: date-time
          description: Data inicial (ISO 8601). Padrao 90 dias atras
        - in: query
          name: to
          schema:
            type: string
            format: date-time
          description: Data final (ISO 8601). Padrao agora
        - in: query
          name: groupBy
          schema:
            type: string
            enum:
              - day
              - week
              - month
              - quarter
            default: week
          description: Unidade de agrupamento temporal
        - in: query
          name: workItemTypeId
          schema:
            type: string
            format: uuid
          description: Filtrar por tipo (opcional)
        - in: query
          name: personId
          schema:
            type: string
            format: uuid
          description: Filtrar por pessoa (opcional)
        - in: query
          name: dimension
          schema:
            type: string
            enum:
              - type
              - person
          description: Dimensão de agrupamento (type ou person). Obrigatório quando tanto workItemTypeId quanto personId estão presentes. Se não especificado e ambos filtros estiverem ausentes, retorna ambas as dimensões.
      responses:
        '200':
          description: Séries de lead time com percentis e estatísticas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LeadCycleTimePeriod'
        '400':
          description: Parâmetros inválidos
        '401':
          description: Não autenticado

  /metrics/cycle-time:
    get:
      tags: [Metrics]
      summary: Cycle time (activated_date → closed_date)
      description: |
        Tempo desde ativação até fechamento. Calculado apenas para itens com activated_date.
        Retorna percentis (p50/p75/p90), média por período, tipo e pessoa.
      parameters:
        - in: query
          name: from
          schema:
            type: string
            format: date-time
          description: Data inicial (ISO 8601). Padrao 90 dias atras
        - in: query
          name: to
          schema:
            type: string
            format: date-time
          description: Data final (ISO 8601). Padrao agora
        - in: query
          name: groupBy
          schema:
            type: string
            enum:
              - day
              - week
              - month
              - quarter
            default: week
          description: Unidade de agrupamento temporal
        - in: query
          name: workItemTypeId
          schema:
            type: string
            format: uuid
          description: Filtrar por tipo (opcional)
        - in: query
          name: personId
          schema:
            type: string
            format: uuid
          description: Filtrar por pessoa (opcional)
        - in: query
          name: dimension
          schema:
            type: string
            enum:
              - type
              - person
          description: Dimensão de agrupamento (type ou person). Obrigatório quando tanto workItemTypeId quanto personId estão presentes. Se não especificado e ambos filtros estiverem ausentes, retorna ambas as dimensões.
      responses:
        '200':
          description: Séries de cycle time com percentis e estatísticas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LeadCycleTimePeriod'
        '400':
          description: Parâmetros inválidos
        '401':
          description: Não autenticado

  /metrics/sla:
    get:
      tags: [Metrics]
      summary: SLA sugerido por tipo
      description: |
        Calcula % de itens que cumpriram SLA. Alvo = p85 do cycle/lead do trimestre anterior (por tipo).
        Retorna total, cumpridos, % de cumprimento e alvo por período e tipo.
      parameters:
        - in: query
          name: from
          schema:
            type: string
            format: date-time
          description: Data inicial (ISO 8601). Padrao 90 dias atras
        - in: query
          name: to
          schema:
            type: string
            format: date-time
          description: Data final (ISO 8601). Padrao agora
        - in: query
          name: groupBy
          schema:
            type: string
            enum:
              - day
              - week
              - month
              - quarter
            default: week
          description: Unidade de agrupamento temporal
      responses:
        '200':
          description: SLA por tipo com % de cumprimento
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SlaPeriod'
        '400':
          description: Parâmetros inválidos
        '401':
          description: Não autenticado

  /metrics/stuck:
    get:
      tags: [Metrics]
      summary: Itens "stuck" (top 20 WIP por aging)
      description: |
        Retorna top 20 itens em progresso ordenados por aging (idade atual em dias).
        Útil para identificar itens que precisam de atenção.
      responses:
        '200':
          description: Top 20 itens stuck
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/StuckItem'
        '401':
          description: Não autenticado

  /metrics/hierarchy:
    get:
      tags: [Metrics]
      summary: Hierarquia de work items (pais e filhos)
      description: |
        Retorna % de conclusão e tempo médio de conclusão dos filhos para cada item pai.
        Ordenado por % de conclusão (mais críticos primeiro).
      responses:
        '200':
          description: Hierarquia com % concluído e lead médio
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/HierarchyItem'
        '401':
          description: Não autenticado

  /metrics/capacity:
    get:
      tags: [Metrics]
      summary: Capacidade por pessoa (throughput por responsável)
      description: |
        Retorna throughput (itens fechados) por período e por pessoa.
        Útil para identificar desbalanceamento de carga.
      parameters:
        - in: query
          name: from
          schema:
            type: string
            format: date-time
          description: Data inicial (ISO 8601). Padrao 90 dias atras
        - in: query
          name: to
          schema:
            type: string
            format: date-time
          description: Data final (ISO 8601). Padrao agora
        - in: query
          name: groupBy
          schema:
            type: string
            enum:
              - day
              - week
              - month
              - quarter
            default: week
          description: Unidade de agrupamento temporal
        - in: query
          name: personId
          schema:
            type: string
            format: uuid
          description: Filtrar por pessoa (opcional)
      responses:
        '200':
          description: Throughput por período e pessoa
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CapacityPeriod'
        '400':
          description: Parâmetros inválidos
        '401':
          description: Não autenticado

  /people:
    get:
      tags: [People]
      summary: Lista pessoas
      description: |
        Retorna lista de pessoas com filtros opcionais por id ou nome (busca parcial case-insensitive).
        Se nenhum filtro for fornecido, retorna todas as pessoas.
      parameters:
        - in: query
          name: id
          schema:
            type: string
            format: uuid
          description: ID da pessoa (UUID)
        - in: query
          name: name
          schema:
            type: string
            minLength: 1
          description: Busca parcial no nome (case-insensitive)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de pessoas
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        name:
                          type: string
                        nameNormalized:
                          type: string
                        createdAt:
                          type: string
                          format: date-time
                        updatedAt:
                          type: string
                          format: date-time
        '400':
          description: Parâmetros inválidos
        '401':
          description: Não autenticado

  /work-item-types:
    get:
      tags: [Work Item Types]
      summary: Lista tipos de work items
      description: |
        Retorna lista de tipos de work items com filtros opcionais por id ou nome (busca parcial case-insensitive).
        Se nenhum filtro for fornecido, retorna todos os tipos.
      parameters:
        - in: query
          name: id
          schema:
            type: string
            format: uuid
          description: ID do tipo (UUID)
        - in: query
          name: name
          schema:
            type: string
            minLength: 1
          description: Busca parcial no nome (case-insensitive)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Lista de tipos de work items
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        name:
                          type: string
                        nameNormalized:
                          type: string
                        createdAt:
                          type: string
                          format: date-time
                        updatedAt:
                          type: string
                          format: date-time
        '400':
          description: Parâmetros inválidos
        '401':
          description: Não autenticado

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    RegisterRequest:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
          example: user@example.com
        password:
          type: string
          minLength: 8
          example: strongPass123
    LoginRequest:
      type: object
      required: [email, password]
      properties:
        email:
          type: string
          format: email
          example: user@example.com
        password:
          type: string
          example: strongPass123
    AuthResponse:
      type: object
      required: [token]
      properties:
        token:
          type: string
          description: JWT Bearer token
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
    WorkItemResponse:
      type: object
      properties:
        id:
          type: integer
          example: 1916409
        workItemTypeId:
          type: string
          format: uuid
          example: "8c2d64a0-7f6d-4e9c-a1a4-6e2e9a6d9d0f"
        workItemType:
          type: string
          example: "Feature"
        state:
          type: string
          example: "Closed"
        createdDate:
          type: string
          format: date-time
          example: "2025-03-26T08:47:00.000Z"
        activatedDate:
          type: string
          format: date-time
          nullable: true
          example: "2025-04-23T11:33:00.000Z"
        closedDate:
          type: string
          format: date-time
          nullable: true
          example: "2025-06-05T11:03:00.000Z"
        title:
          type: string
          example: "[Estoque] Raiz"
        description:
          type: string
          nullable: true
          example: "Fluxo"
        assignedTo:
          type: string
          nullable: true
          example: "Bruno"
        assignedToId:
          type: string
          format: uuid
          nullable: true
          example: "8c2d64a0-7f6d-4e9c-a1a4-6e2e9a6d9d0f"
        parentId:
          type: integer
          nullable: true
          example: null
        createdAt:
          type: string
          format: date-time
          example: "2025-01-01T00:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2025-01-01T00:00:00.000Z"
        developmentBusinessDays:
          type: integer
          nullable: true
          description: Número de dias úteis de desenvolvimento (seg-sex, excluindo feriados do Brasil). null se não houver closedDate.
          example: 42

    WorkItemsListResponse:
      type: object
      properties:
        total:
          type: integer
          example: 123
        summary:
          $ref: '#/components/schemas/WorkItemsSummary'
        items:
          type: array
          items:
            $ref: '#/components/schemas/WorkItemResponse'

    WorkItemsSummary:
      type: object
      properties:
        total:
          type: integer
          description: Total de itens que batem o filtro (sem paginação)
          example: 123
        closed:
          type: integer
          description: Total de itens fechados que batem o filtro (sem paginação)
          example: 80
        avgDevelopmentBusinessDays:
          type: number
          format: float
          nullable: true
          description: Média de dias úteis de desenvolvimento entre início e fechamento, considerando apenas itens fechados
          example: 17.4

    ThroughputPeriod:
      type: object
      properties:
        period:
          type: string
          format: date-time
          description: Início do período (agrupado por groupBy)
          example: "2025-01-01T00:00:00.000Z"
        work_item_type_id:
          type: string
          format: uuid
          nullable: true
          description: ID do tipo de work item (presente apenas quando filtrado por workItemTypeId)
          example: "8c2d64a0-7f6d-4e9c-a1a4-6e2e9a6d9d0f"
        type_name:
          type: string
          description: Nome do tipo de work item
          example: "Feature"
        closed_count:
          type: integer
          description: Quantidade de itens fechados no período
          example: 15

    ArrivalThroughputPeriod:
      type: object
      properties:
        period:
          type: string
          format: date-time
          description: Início do período
          example: "2025-01-01T00:00:00.000Z"
        created:
          type: integer
          description: Quantidade de itens criados no período
          example: 20
        closed:
          type: integer
          description: Quantidade de itens fechados no período
          example: 15
        delta:
          type: integer
          description: Diferença chegada - throughput (acumulação/queima)
          example: 5

    WipSnapshot:
      type: object
      properties:
        total:
          $ref: '#/components/schemas/WipDimension'
        byType:
          type: array
          items:
            $ref: '#/components/schemas/WipDimension'
          description: WIP agrupado por tipo
        byPerson:
          type: array
          items:
            $ref: '#/components/schemas/WipDimension'
          description: WIP agrupado por pessoa

    WipDimension:
      type: object
      properties:
        dimension:
          type: string
          enum: [total, type, person]
          example: "type"
        name:
          type: string
          nullable: true
          description: Nome da dimensão (tipo ou pessoa). null para total
          example: "Feature"
        wip_count:
          type: integer
          description: Quantidade de itens em progresso
          example: 25
        aging_avg:
          type: string
          description: Aging médio como intervalo PostgreSQL
          example: "45 days 12:30:00"
        p50:
          type: string
          description: Percentil 50 de aging
          example: "30 days 00:00:00"
        p75:
          type: string
          description: Percentil 75 de aging
          example: "60 days 00:00:00"
        p85:
          type: string
          description: Percentil 85 de aging
          example: "75 days 00:00:00"
        p90:
          type: string
          description: Percentil 90 de aging
          example: "90 days 00:00:00"
        p95:
          type: string
          description: Percentil 95 de aging
          example: "120 days 00:00:00"

    LeadCycleTimePeriod:
      type: object
      properties:
        dimension:
          type: string
          enum: [type, person]
          example: "type"
        name:
          type: string
          description: Nome do tipo ou pessoa (ou "(unassigned)")
          example: "Feature"
        period:
          type: string
          format: date-time
          description: Início do período
          example: "2025-01-01T00:00:00.000Z"
        n:
          type: integer
          description: Quantidade de itens no período
          example: 50
        lead_avg:
          type: string
          description: Lead time médio (intervalo PostgreSQL)
          example: "45 days 12:30:00"
        lead_std:
          type: number
          format: double
          nullable: true
          description: Desvio padrão do lead time
          example: 15.5
        lead_p50:
          type: string
          description: Percentil 50 do lead time
          example: "40 days 00:00:00"
        lead_p75:
          type: string
          description: Percentil 75 do lead time
          example: "55 days 00:00:00"
        lead_p85:
          type: string
          description: Percentil 85 do lead time
          example: "65 days 00:00:00"
        lead_p90:
          type: string
          description: Percentil 90 do lead time
          example: "75 days 00:00:00"
        lead_p95:
          type: string
          description: Percentil 95 do lead time
          example: "90 days 00:00:00"
        cycle_avg:
          type: string
          nullable: true
          description: Cycle time médio (null se não houver activated_date)
          example: "30 days 08:15:00"
        cycle_p50:
          type: string
          nullable: true
          description: Percentil 50 do cycle time
          example: "25 days 00:00:00"
        cycle_p75:
          type: string
          nullable: true
          description: Percentil 75 do cycle time
          example: "40 days 00:00:00"
        cycle_p90:
          type: string
          nullable: true
          description: Percentil 90 do cycle time
          example: "55 days 00:00:00"

    SlaPeriod:
      type: object
      properties:
        period:
          type: string
          format: date-time
          description: Início do período
          example: "2025-01-01T00:00:00.000Z"
        type_name:
          type: string
          description: Nome do tipo de work item
          example: "Feature"
        total:
          type: integer
          description: Total de itens fechados no período
          example: 50
        met:
          type: integer
          description: Quantidade que cumpriram SLA
          example: 42
        met_pct:
          type: number
          format: float
          description: Percentual de cumprimento (0-100)
          example: 84.0
        sla_target:
          type: string
          nullable: true
          description: Alvo de SLA (p85 do trimestre anterior, intervalo PostgreSQL)
          example: "60 days 00:00:00"

    StuckItem:
      type: object
      properties:
        id:
          type: integer
          description: ID do work item
          example: 1916409
        title:
          type: string
          description: Título do item
          example: "[Estoque] Implementar módulo de relatórios"
        type_name:
          type: string
          description: Nome do tipo
          example: "Feature"
        person_name:
          type: string
          description: Nome da pessoa responsável (ou "(unassigned)")
          example: "Bruno"
        aging_days:
          type: number
          format: double
          description: Aging atual em dias
          example: 125.5

    HierarchyItem:
      type: object
      properties:
        parent_id:
          type: integer
          description: ID do item pai
          example: 1000000
        parent_title:
          type: string
          nullable: true
          description: Título do pai (null se não encontrado)
          example: "[EPIC] Autenticação"
        total_children:
          type: integer
          description: Total de filhos
          example: 20
        closed_children:
          type: integer
          description: Filhos concluídos
          example: 15
        percent_closed:
          type: number
          format: float
          nullable: true
          description: Percentual concluído (0-100)
          example: 75.0
        avg_lead:
          type: string
          nullable: true
          description: Lead time médio dos filhos concluídos (intervalo PostgreSQL)
          example: "45 days 12:30:00"

    CapacityPeriod:
      type: object
      properties:
        period:
          type: string
          format: date-time
          description: Início do período
          example: "2025-01-01T00:00:00.000Z"
        person_name:
          type: string
          description: Nome da pessoa (ou "(unassigned)")
          example: "Bruno"
        closed_count:
          type: integer
          description: Quantidade de itens fechados no período por essa pessoa
          example: 12

security:
  - bearerAuth: []


